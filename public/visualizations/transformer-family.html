<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Transformer 三大架构家族</title>
<style>
:root {
  --bg: #0f172a;
  --card: rgba(30,41,59,0.7);
  --text: #e2e8f0;
  --muted: #94a3b8;
  --primary: #38bdf8;
  --accent: #22c55e;
  --warn: #f59e0b;
  --purple: #8b5cf6;
}
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
body {
  background: radial-gradient(circle at 20% 20%, #162542 0%, #0f172a 45%);
  background-color: var(--bg);
  color: var(--text);
  font-family: "Segoe UI","PingFang SC","Microsoft YaHei",sans-serif;
  line-height: 1.6;
  min-height: 100vh;
  padding: 2rem 1rem;
}
.container { max-width: 1080px; margin: 0 auto; }

/* ---- Title ---- */
.main-title {
  text-align: center;
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  background: linear-gradient(90deg, var(--primary), var(--purple), var(--accent));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}
.subtitle { text-align: center; color: var(--muted); font-size: 0.95rem; margin-bottom: 2rem; }

/* ---- Tab buttons ---- */
.tab-bar {
  display: flex; gap: 0.5rem; justify-content: center;
  margin-bottom: 2rem; flex-wrap: wrap;
}
.tab-btn {
  padding: 0.5rem 1.5rem; border: 2px solid var(--muted); border-radius: 999px;
  background: transparent; color: var(--muted); font-size: 0.95rem;
  cursor: pointer; transition: all 0.3s;
  font-family: inherit;
}
.tab-btn:hover { border-color: var(--text); color: var(--text); }
.tab-btn.active-bert { border-color: var(--primary); color: var(--primary); background: rgba(56,189,248,0.1); }
.tab-btn.active-gpt  { border-color: var(--purple); color: var(--purple); background: rgba(139,92,246,0.1); }
.tab-btn.active-t5   { border-color: var(--accent); color: var(--accent); background: rgba(34,197,94,0.1); }
.tab-btn.active-all  { border-color: var(--warn); color: var(--warn); background: rgba(245,158,11,0.1); }

/* ---- Cards grid ---- */
.cards-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1.25rem;
  margin-bottom: 2rem;
}
@media (max-width: 900px) {
  .cards-grid { grid-template-columns: 1fr; }
}
.arch-card {
  background: var(--card);
  border-radius: 16px;
  padding: 1.5rem;
  border: 1px solid rgba(148,163,184,0.15);
  transition: all 0.4s;
  cursor: pointer;
  position: relative;
  overflow: hidden;
}
.arch-card::before {
  content: '';
  position: absolute; top: 0; left: 0; right: 0; height: 3px;
  border-radius: 16px 16px 0 0;
}
.arch-card.bert-card::before { background: var(--primary); }
.arch-card.gpt-card::before  { background: var(--purple); }
.arch-card.t5-card::before   { background: var(--accent); }
.arch-card:hover { transform: translateY(-4px); border-color: rgba(148,163,184,0.3); }
.arch-card.focused { transform: translateY(-4px); }
.arch-card.bert-card.focused { border-color: var(--primary); box-shadow: 0 0 30px rgba(56,189,248,0.15); }
.arch-card.gpt-card.focused  { border-color: var(--purple); box-shadow: 0 0 30px rgba(139,92,246,0.15); }
.arch-card.t5-card.focused   { border-color: var(--accent); box-shadow: 0 0 30px rgba(34,197,94,0.15); }
.arch-card.dimmed { opacity: 0.35; transform: scale(0.97); }

.card-header {
  font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem;
  display: flex; align-items: center; gap: 0.5rem;
}
.card-header .badge {
  font-size: 0.7rem; padding: 2px 8px; border-radius: 999px;
  font-weight: 500;
}
.bert-card .card-header { color: var(--primary); }
.bert-card .badge { background: rgba(56,189,248,0.15); color: var(--primary); }
.gpt-card .card-header  { color: var(--purple); }
.gpt-card .badge  { background: rgba(139,92,246,0.15); color: var(--purple); }
.t5-card .card-header   { color: var(--accent); }
.t5-card .badge   { background: rgba(34,197,94,0.15); color: var(--accent); }

/* ---- Diagram blocks ---- */
.diagram { display: flex; flex-direction: column; align-items: center; gap: 0; margin-bottom: 1rem; }
.diagram .block {
  width: 100%; text-align: center; padding: 0.45rem 0.5rem;
  border-radius: 8px; font-size: 0.82rem; font-weight: 500;
  border: 1px solid; position: relative;
}
.diagram .arrow-down {
  font-size: 1rem; line-height: 1; margin: 2px 0; color: var(--muted);
}
.bert-card .block { border-color: rgba(56,189,248,0.3); background: rgba(56,189,248,0.08); color: var(--primary); }
.gpt-card .block  { border-color: rgba(139,92,246,0.3); background: rgba(139,92,246,0.08); color: var(--purple); }
.t5-card .block   { border-color: rgba(34,197,94,0.3); background: rgba(34,197,94,0.08); color: var(--accent); }

.direction-label {
  text-align: center; font-size: 1.3rem; margin-bottom: 0.5rem;
  letter-spacing: 0.2rem;
}
.bert-card .direction-label { color: var(--primary); }
.gpt-card .direction-label  { color: var(--purple); }
.t5-card .direction-label   { color: var(--accent); }

.key-text {
  text-align: center; font-size: 0.82rem; color: var(--muted);
  padding: 0.5rem; background: rgba(15,23,42,0.5); border-radius: 8px;
}

/* ---- T5 special diagram ---- */
.t5-diagram-wrap {
  display: flex; gap: 0.75rem; align-items: flex-start;
  margin-bottom: 1rem;
}
.t5-half { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 0; }
.t5-half-label { font-size: 0.75rem; color: var(--muted); margin-bottom: 0.35rem; font-weight: 600; }
.cross-arrow {
  display: flex; align-items: center; justify-content: center;
  font-size: 1.2rem; color: var(--accent); align-self: center;
  writing-mode: horizontal-tb; padding-top: 2.5rem;
}

/* ---- Heatmaps ---- */
.section-title {
  font-size: 1.25rem; font-weight: 600; text-align: center;
  margin: 2.5rem 0 1.5rem;
}
.heatmaps-grid {
  display: grid; grid-template-columns: repeat(3, 1fr);
  gap: 1.25rem; margin-bottom: 2rem;
}
@media (max-width: 900px) { .heatmaps-grid { grid-template-columns: 1fr; } }
.heatmap-panel {
  background: var(--card); border-radius: 16px; padding: 1.25rem;
  border: 1px solid rgba(148,163,184,0.15); text-align: center;
  transition: all 0.4s;
}
.heatmap-panel.dimmed { opacity: 0.35; transform: scale(0.97); }
.heatmap-label { font-size: 0.9rem; font-weight: 600; margin-bottom: 0.75rem; }
.heatmap-label.bert-label { color: var(--primary); }
.heatmap-label.gpt-label  { color: var(--purple); }
.heatmap-label.t5-label   { color: var(--accent); }
canvas.heatmap-canvas { border-radius: 6px; }
.heatmap-caption { font-size: 0.75rem; color: var(--muted); margin-top: 0.5rem; }

.t5-heatmap-pair { display: flex; gap: 0.75rem; justify-content: center; align-items: center; }
.t5-heatmap-sub { text-align: center; }
.t5-heatmap-sub .sub-label { font-size: 0.7rem; color: var(--muted); margin-bottom: 4px; }

/* ---- Training demos ---- */
.demos-grid {
  display: grid; grid-template-columns: repeat(3, 1fr);
  gap: 1.25rem; margin-bottom: 2rem;
}
@media (max-width: 900px) { .demos-grid { grid-template-columns: 1fr; } }
.demo-panel {
  background: var(--card); border-radius: 16px; padding: 1.25rem;
  border: 1px solid rgba(148,163,184,0.15); text-align: center;
  transition: all 0.4s;
}
.demo-panel.dimmed { opacity: 0.35; transform: scale(0.97); }
.demo-label { font-size: 0.9rem; font-weight: 600; margin-bottom: 0.25rem; }
.demo-sublabel { font-size: 0.78rem; color: var(--muted); margin-bottom: 1rem; }
.demo-label.bert-label { color: var(--primary); }
.demo-label.gpt-label  { color: var(--purple); }
.demo-label.t5-label   { color: var(--accent); }

.token-row {
  display: flex; justify-content: center; gap: 0.4rem;
  flex-wrap: wrap; margin-bottom: 0.5rem;
  min-height: 2.4rem; align-items: center;
}
.token {
  display: inline-flex; align-items: center; justify-content: center;
  padding: 0.3rem 0.7rem; border-radius: 6px;
  font-size: 0.88rem; font-weight: 500;
  border: 1px solid rgba(148,163,184,0.2);
  background: rgba(15,23,42,0.6);
  transition: all 0.4s;
}
.token.mask {
  border-style: dashed; color: var(--muted);
}
.token.reveal {
  animation: revealPop 0.5s ease;
}
.token.bert-reveal { border-color: var(--primary); color: var(--primary); background: rgba(56,189,248,0.15); }
.token.gpt-reveal  { border-color: var(--purple); color: var(--purple); background: rgba(139,92,246,0.15); }
.token.t5-reveal   { border-color: var(--accent); color: var(--accent); background: rgba(34,197,94,0.15); }
@keyframes revealPop {
  0% { transform: scale(0.5); opacity: 0; }
  60% { transform: scale(1.15); }
  100% { transform: scale(1); opacity: 1; }
}

.demo-arrow { font-size: 1.1rem; color: var(--muted); margin: 0.5rem 0; }
.demo-btn {
  margin-top: 0.75rem; padding: 0.4rem 1.2rem;
  border-radius: 999px; border: 1px solid; background: transparent;
  font-size: 0.82rem; cursor: pointer; font-family: inherit;
  transition: all 0.3s;
}
.demo-btn.bert-btn { border-color: var(--primary); color: var(--primary); }
.demo-btn.bert-btn:hover { background: rgba(56,189,248,0.15); }
.demo-btn.gpt-btn  { border-color: var(--purple); color: var(--purple); }
.demo-btn.gpt-btn:hover  { background: rgba(139,92,246,0.15); }
.demo-btn.t5-btn   { border-color: var(--accent); color: var(--accent); }
.demo-btn.t5-btn:hover   { background: rgba(34,197,94,0.15); }

/* ---- Comparison table ---- */
.table-wrap {
  background: var(--card); border-radius: 16px;
  border: 1px solid rgba(148,163,184,0.15);
  overflow-x: auto; margin-bottom: 2rem;
}
table {
  width: 100%; border-collapse: collapse;
  font-size: 0.85rem;
}
thead th {
  padding: 0.85rem 1rem; text-align: left; font-weight: 600;
  border-bottom: 1px solid rgba(148,163,184,0.2);
  background: rgba(15,23,42,0.4);
}
thead th:nth-child(2) { color: var(--primary); }
thead th:nth-child(3) { color: var(--purple); }
thead th:nth-child(4) { color: var(--accent); }
tbody td {
  padding: 0.7rem 1rem;
  border-bottom: 1px solid rgba(148,163,184,0.07);
}
tbody tr:last-child td { border-bottom: none; }
tbody tr:hover { background: rgba(148,163,184,0.05); }
tbody td:first-child { color: var(--muted); font-weight: 500; }

/* ---- footer ---- */
.footer { text-align: center; color: var(--muted); font-size: 0.78rem; padding: 1rem 0; }
</style>
</head>
<body>
<div class="container">

  <!-- Title -->
  <h1 class="main-title">Transformer 三大架构家族</h1>
  <p class="subtitle">BERT (编码器) &middot; GPT (解码器) &middot; T5 (编码器-解码器) &mdash; 交互式对比</p>

  <!-- Tab bar -->
  <div class="tab-bar">
    <button class="tab-btn active-all" data-tab="all" onclick="switchTab('all')">全部对比</button>
    <button class="tab-btn" data-tab="bert" onclick="switchTab('bert')">BERT</button>
    <button class="tab-btn" data-tab="gpt"  onclick="switchTab('gpt')">GPT</button>
    <button class="tab-btn" data-tab="t5"   onclick="switchTab('t5')">T5</button>
  </div>

  <!-- ================= Architecture Cards ================= -->
  <div class="cards-grid">

    <!-- BERT Card -->
    <div class="arch-card bert-card" data-arch="bert" onclick="switchTab('bert')">
      <div class="card-header">
        编码器架构 (BERT)
        <span class="badge">Encoder-Only</span>
      </div>
      <div class="diagram">
        <div class="block">双向自注意力</div>
        <div class="arrow-down">&#x25BC;</div>
        <div class="block">Add &amp; Norm</div>
        <div class="arrow-down">&#x25BC;</div>
        <div class="block">FFN (前馈网络)</div>
        <div class="arrow-down">&#x25BC;</div>
        <div class="block">Add &amp; Norm</div>
      </div>
      <div class="direction-label">&#x2194; 双向</div>
      <div class="key-text">双向注意力，看到全部上下文</div>
    </div>

    <!-- GPT Card -->
    <div class="arch-card gpt-card" data-arch="gpt" onclick="switchTab('gpt')">
      <div class="card-header">
        解码器架构 (GPT)
        <span class="badge">Decoder-Only</span>
      </div>
      <div class="diagram">
        <div class="block">因果自注意力</div>
        <div class="arrow-down">&#x25BC;</div>
        <div class="block">Add &amp; Norm</div>
        <div class="arrow-down">&#x25BC;</div>
        <div class="block">FFN (前馈网络)</div>
        <div class="arrow-down">&#x25BC;</div>
        <div class="block">Add &amp; Norm</div>
      </div>
      <div class="direction-label">&#x2192; 从左到右</div>
      <div class="key-text">因果注意力，只看左侧上下文</div>
    </div>

    <!-- T5 Card -->
    <div class="arch-card t5-card" data-arch="t5" onclick="switchTab('t5')">
      <div class="card-header">
        编码器-解码器 (T5)
        <span class="badge">Encoder-Decoder</span>
      </div>
      <div class="t5-diagram-wrap">
        <div class="t5-half">
          <div class="t5-half-label">编码器</div>
          <div class="diagram">
            <div class="block">双向自注意力</div>
            <div class="arrow-down">&#x25BC;</div>
            <div class="block">Add &amp; Norm</div>
            <div class="arrow-down">&#x25BC;</div>
            <div class="block">FFN</div>
          </div>
        </div>
        <div class="cross-arrow">&#x27A1;</div>
        <div class="t5-half">
          <div class="t5-half-label">解码器</div>
          <div class="diagram">
            <div class="block">因果自注意力</div>
            <div class="arrow-down">&#x25BC;</div>
            <div class="block">交叉注意力</div>
            <div class="arrow-down">&#x25BC;</div>
            <div class="block">FFN</div>
          </div>
        </div>
      </div>
      <div class="direction-label">&#x2194;&#xFE0E; + &#x2192;</div>
      <div class="key-text">双向编码 + 因果解码</div>
    </div>

  </div>

  <!-- ================= Attention Heatmaps ================= -->
  <h2 class="section-title">注意力模式热力图 (6&times;6)</h2>
  <div class="heatmaps-grid">
    <div class="heatmap-panel" data-arch="bert">
      <div class="heatmap-label bert-label">BERT &mdash; 全连接矩阵</div>
      <canvas class="heatmap-canvas" id="heatBert" width="180" height="180"></canvas>
      <div class="heatmap-caption">每个 token 可关注所有位置</div>
    </div>
    <div class="heatmap-panel" data-arch="gpt">
      <div class="heatmap-label gpt-label">GPT &mdash; 下三角掩码</div>
      <canvas class="heatmap-canvas" id="heatGpt" width="180" height="180"></canvas>
      <div class="heatmap-caption">每个 token 只看当前及之前位置</div>
    </div>
    <div class="heatmap-panel" data-arch="t5">
      <div class="heatmap-label t5-label">T5 &mdash; 编码器 + 解码器</div>
      <div class="t5-heatmap-pair">
        <div class="t5-heatmap-sub">
          <div class="sub-label">编码器 (全连接)</div>
          <canvas class="heatmap-canvas" id="heatT5Enc" width="84" height="84"></canvas>
        </div>
        <div class="t5-heatmap-sub">
          <div class="sub-label">解码器 (因果)</div>
          <canvas class="heatmap-canvas" id="heatT5Dec" width="84" height="84"></canvas>
        </div>
      </div>
      <div class="heatmap-caption">编码器全连接，解码器因果掩码</div>
    </div>
  </div>

  <!-- ================= Training Demos ================= -->
  <h2 class="section-title">训练目标动画演示</h2>
  <div class="demos-grid">

    <!-- BERT MLM -->
    <div class="demo-panel" data-arch="bert">
      <div class="demo-label bert-label">BERT &mdash; MLM</div>
      <div class="demo-sublabel">掩码语言模型 (Masked Language Model)</div>
      <div class="token-row" id="bertInput">
        <span class="token">我</span>
        <span class="token mask" id="bertMask">[MASK]</span>
        <span class="token">自然语言处理</span>
      </div>
      <div class="demo-arrow">&#x25BC;</div>
      <div class="token-row" id="bertOutput">
        <span class="token">我</span>
        <span class="token" id="bertReveal" style="visibility:hidden;">爱</span>
        <span class="token">自然语言处理</span>
      </div>
      <button class="demo-btn bert-btn" id="bertBtn" onclick="runBertDemo()">预测 [MASK]</button>
    </div>

    <!-- GPT CLM -->
    <div class="demo-panel" data-arch="gpt">
      <div class="demo-label gpt-label">GPT &mdash; CLM</div>
      <div class="demo-sublabel">因果语言模型 (Causal Language Model)</div>
      <div class="token-row" id="gptInput">
        <span class="token">我</span>
        <span class="token">爱</span>
        <span class="token">自然</span>
      </div>
      <div class="demo-arrow">&#x25BC;</div>
      <div class="token-row" id="gptOutput">
        <span class="token">我</span>
        <span class="token">爱</span>
        <span class="token">自然</span>
        <span class="token" id="gptReveal" style="visibility:hidden;">语言</span>
      </div>
      <button class="demo-btn gpt-btn" id="gptBtn" onclick="runGptDemo()">生成下一个</button>
    </div>

    <!-- T5 Span -->
    <div class="demo-panel" data-arch="t5">
      <div class="demo-label t5-label">T5 &mdash; Span Corruption</div>
      <div class="demo-sublabel">跨度损坏与恢复</div>
      <div class="token-row" id="t5Input">
        <span class="token">我</span>
        <span class="token mask">&lt;X&gt;</span>
        <span class="token">语言处理</span>
      </div>
      <div class="demo-arrow">&#x25BC;</div>
      <div class="token-row" id="t5Output">
        <span class="token" id="t5Reveal1" style="visibility:hidden;">&lt;X&gt;</span>
        <span class="token" id="t5Reveal2" style="visibility:hidden;">爱</span>
        <span class="token" id="t5Reveal3" style="visibility:hidden;">自然</span>
      </div>
      <button class="demo-btn t5-btn" id="t5Btn" onclick="runT5Demo()">恢复跨度</button>
    </div>

  </div>

  <!-- ================= Comparison Table ================= -->
  <h2 class="section-title">架构对比总览</h2>
  <div class="table-wrap">
    <table>
      <thead>
        <tr>
          <th>维度</th>
          <th>BERT</th>
          <th>GPT</th>
          <th>T5</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>架构类型</td>
          <td>仅编码器</td>
          <td>仅解码器</td>
          <td>编码器-解码器</td>
        </tr>
        <tr>
          <td>注意力方向</td>
          <td>双向 (全部上下文)</td>
          <td>单向 (仅左侧)</td>
          <td>编码器双向 + 解码器单向</td>
        </tr>
        <tr>
          <td>训练目标</td>
          <td>掩码语言模型 (MLM)</td>
          <td>因果语言模型 (CLM)</td>
          <td>跨度损坏恢复</td>
        </tr>
        <tr>
          <td>擅长任务</td>
          <td>分类、NER、问答</td>
          <td>文本生成、对话、代码</td>
          <td>翻译、摘要、多任务</td>
        </tr>
        <tr>
          <td>代表模型</td>
          <td>BERT, RoBERTa, DeBERTa</td>
          <td>GPT-4, LLaMA, Mistral</td>
          <td>T5, BART, mT5</td>
        </tr>
        <tr>
          <td>输入输出</td>
          <td>文本 &rarr; 向量表征</td>
          <td>前缀 &rarr; 续写文本</td>
          <td>文本 &rarr; 文本 (seq2seq)</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="footer">Transformer 架构家族 &mdash; 交互式可视化</div>
</div>

<script>
/* ====== Tab switching ====== */
var currentTab = 'all';

function switchTab(tab) {
  currentTab = tab;
  var btns = document.querySelectorAll('.tab-btn');
  btns.forEach(function(b) {
    b.className = 'tab-btn';
    if (b.getAttribute('data-tab') === tab) {
      var cls = tab === 'all' ? 'active-all' : ('active-' + tab);
      b.classList.add(cls);
    }
  });

  var allPanels = document.querySelectorAll('.arch-card, .heatmap-panel, .demo-panel');
  allPanels.forEach(function(el) {
    var arch = el.getAttribute('data-arch');
    el.classList.remove('focused', 'dimmed');
    if (tab === 'all') return;
    if (arch === tab) {
      el.classList.add('focused');
    } else {
      el.classList.add('dimmed');
    }
  });
}

/* ====== Heatmap drawing ====== */
function drawHeatmap(canvasId, size, maskFn, color) {
  var canvas = document.getElementById(canvasId);
  var ctx = canvas.getContext('2d');
  var w = canvas.width;
  var h = canvas.height;
  var cell = w / size;
  var gap = 2;

  ctx.clearRect(0, 0, w, h);

  for (var row = 0; row < size; row++) {
    for (var col = 0; col < size; col++) {
      var show = maskFn(row, col);
      if (show) {
        var alpha = 0.45 + Math.random() * 0.45;
        ctx.fillStyle = hexToRgba(color, alpha);
      } else {
        ctx.fillStyle = 'rgba(30,41,59,0.5)';
      }
      ctx.beginPath();
      ctx.roundRect(col * cell + gap / 2, row * cell + gap / 2, cell - gap, cell - gap, 3);
      ctx.fill();
    }
  }
}

function hexToRgba(hex, a) {
  var r = parseInt(hex.slice(1, 3), 16);
  var g = parseInt(hex.slice(3, 5), 16);
  var b = parseInt(hex.slice(5, 7), 16);
  return 'rgba(' + r + ',' + g + ',' + b + ',' + a + ')';
}

/* Polyfill roundRect for older browsers */
if (!CanvasRenderingContext2D.prototype.roundRect) {
  CanvasRenderingContext2D.prototype.roundRect = function(x, y, w, h, r) {
    if (typeof r === 'number') r = [r, r, r, r];
    this.moveTo(x + r[0], y);
    this.lineTo(x + w - r[1], y);
    this.arcTo(x + w, y, x + w, y + r[1], r[1]);
    this.lineTo(x + w, y + h - r[2]);
    this.arcTo(x + w, y + h, x + w - r[2], y + h, r[2]);
    this.lineTo(x + r[3], y + h);
    this.arcTo(x, y + h, x, y + h - r[3], r[3]);
    this.lineTo(x, y + r[0]);
    this.arcTo(x, y, x + r[0], y, r[0]);
    this.closePath();
  };
}

function initHeatmaps() {
  drawHeatmap('heatBert', 6, function() { return true; }, '#38bdf8');
  drawHeatmap('heatGpt', 6, function(r, c) { return c <= r; }, '#8b5cf6');
  drawHeatmap('heatT5Enc', 6, function() { return true; }, '#22c55e');
  drawHeatmap('heatT5Dec', 6, function(r, c) { return c <= r; }, '#22c55e');
}

/* ====== Training demos ====== */
var bertRunning = false;
var gptRunning = false;
var t5Running = false;

function runBertDemo() {
  if (bertRunning) return;
  bertRunning = true;
  var mask = document.getElementById('bertMask');
  var reveal = document.getElementById('bertReveal');
  var btn = document.getElementById('bertBtn');
  btn.textContent = '预测中...';

  reveal.style.visibility = 'hidden';
  reveal.classList.remove('reveal', 'bert-reveal');
  mask.style.borderColor = '';
  mask.style.color = '';

  setTimeout(function() {
    mask.style.borderColor = 'var(--primary)';
    mask.style.color = 'var(--primary)';
  }, 300);

  setTimeout(function() {
    reveal.style.visibility = 'visible';
    reveal.classList.add('reveal', 'bert-reveal');
    btn.textContent = '重新演示';
    bertRunning = false;
  }, 900);
}

function runGptDemo() {
  if (gptRunning) return;
  gptRunning = true;
  var reveal = document.getElementById('gptReveal');
  var btn = document.getElementById('gptBtn');
  btn.textContent = '生成中...';

  reveal.style.visibility = 'hidden';
  reveal.classList.remove('reveal', 'gpt-reveal');

  setTimeout(function() {
    reveal.style.visibility = 'visible';
    reveal.classList.add('reveal', 'gpt-reveal');
    btn.textContent = '重新演示';
    gptRunning = false;
  }, 800);
}

function runT5Demo() {
  if (t5Running) return;
  t5Running = true;
  var r1 = document.getElementById('t5Reveal1');
  var r2 = document.getElementById('t5Reveal2');
  var r3 = document.getElementById('t5Reveal3');
  var btn = document.getElementById('t5Btn');
  btn.textContent = '恢复中...';

  [r1, r2, r3].forEach(function(el) {
    el.style.visibility = 'hidden';
    el.classList.remove('reveal', 't5-reveal');
  });

  setTimeout(function() {
    r1.style.visibility = 'visible';
    r1.classList.add('reveal', 't5-reveal');
  }, 500);

  setTimeout(function() {
    r2.style.visibility = 'visible';
    r2.classList.add('reveal', 't5-reveal');
  }, 900);

  setTimeout(function() {
    r3.style.visibility = 'visible';
    r3.classList.add('reveal', 't5-reveal');
    btn.textContent = '重新演示';
    t5Running = false;
  }, 1300);
}

/* ====== Init ====== */
window.addEventListener('DOMContentLoaded', function() {
  initHeatmaps();
});

/* ====== iframe height reporting ====== */
(function(){var s=function(){if(window.parent===window)return;var h=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight);window.parent.postMessage({type:'iframe-height',height:h},'*')};window.addEventListener('load',s);window.addEventListener('resize',s);if('ResizeObserver' in window){var o=new ResizeObserver(s);if(document.body)o.observe(document.body);if(document.documentElement)o.observe(document.documentElement)}requestAnimationFrame(s);setTimeout(s,250);setTimeout(s,1000)})();
</script>
</body>
</html>